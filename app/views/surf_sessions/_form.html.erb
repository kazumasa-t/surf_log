<%= form_with model: surf_session, local: true, html: { multipart: true } do |f| %>

  <div class="form-field">
    <%= f.label :session_date do %>
      日付<span class="required">*</span>
    <% end %>

    <% if surf_session.persisted? %>
      <%= f.date_field :session_date, required: true, disabled: true %>
      <%= f.hidden_field :session_date %>
    <% else %>
      <%= f.date_field :session_date, required: true %>
    <% end %>
  </div>

  <div class="form-field">
    <%= f.label :duration_minutes do %>
      時間（分）<span class="required">*</span>
    <% end %>

    <%= f.select :duration_minutes,
          (30..360).step(30).to_a,
          { include_blank: "選択してください" },
          { required: true } %>
  </div>

  <div class="form-field">
    <%= f.label :point_id, "ポイント" %>
    <%= f.collection_select :point_id, @points, :id, :name,
          { include_blank: "選択してください" } %>
  </div>

  <div class="form-field">
    <%= f.label :wave_size, "波のサイズ" %>
    <%= f.select :wave_size,
          ["ヒザ～モモ", "コシ～ハラ", "ムネ～カタ", "～頭", "～オーバーヘッド"],
          { include_blank: "選択してください" } %>
  </div>

  <% if surf_session.persisted? && surf_session.photo.attached? %>
    <div class="form-field">
      <label>現在の写真</label><br>
      <%= image_tag url_for(surf_session.photo),
            style: "width:100%; object-fit:cover; border-radius:12px;" %>
    </div>
  <% end %>

  <div class="form-field">
    <%= f.label :photo, surf_session.persisted? ? "写真を変更" : "写真" %>
    <%= f.file_field :photo, accept: "image/*" %>
  </div>

  <div class="form-field">
    <%= f.label :note, "メモ" %>
    <%= f.text_area :note %>
  </div>

  <div class="form-actions">
    <%= f.submit surf_session.persisted? ? "更新" : "保存", class: "btn-primary" %>
    <%= link_to "戻る", root_path, class: "btn-secondary" %>
  </div>

  <% if surf_session.persisted? %>
    <hr style="margin: 24px 0;">
    <%= link_to "この記録を削除",
          surf_session_path(surf_session),
          data: {
            turbo_method: :delete,
            turbo_confirm: "この日のサーフ記録を削除します。本当にいいですか？"
          },
          class: "btn-delete" %>
  <% end %>

<% end %>
